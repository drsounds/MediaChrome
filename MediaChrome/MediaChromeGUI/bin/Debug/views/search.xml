<?
/*****
 * Home view for Segurify
 */
 var result = findMusic(parameter);

 
 /*  */
?>
<view>
	<section name="Search result for @{parameter}" list="true" >
		<columnheader noelm="true" name=" " size="20" />

		<columnheader noelm="true" name="Title" size="320" />
		<columnheader noelm="true" name="Artist" size="320" />
		<columnheader noelm="true" name="Album" size="320" />
		<table width="100%">
			<tr>	
				<td width="100%">
					<b>Artists</b><br/>
					<?
					var artists = findArtist(engine,parameter);
					for(var i=0; i < artists.Length; i++){ var artist = artists[i];
					?><a href="@{artist.Link}">@{artist.Name}</a> ●
					<? } ?>
					

				</td>
				<td width="100%">
					<b>Albums</b>
					<?
					var artists = findAlbum(engine,parameter);
					for(var i=0; i < albums.Length; i++){ var album = album[i];
					?><a href="@{album.Link}">@{album.Name}</a> ●
					<? } ?>
				</td>
			</tr>
		</table>
		<space height="128" />
		<!--<label height="50" color="#aaeeaa" left="10" top="@TOP" width="500">Did you mean</label> -->
		
<?

for(var i=0; i < result.Count; i++){
try{
var Title = result[i].Name.replace("<","").replace(">","").replace("&","&nd;");
var Artist =  result[i].Artists[0].Name;

var artist_uri = result[i].Artists[0].Link;
var Album = result[i].Album.Name;
var album_uri = result[i].Album.Link.replace("&","&nd;");
	var uri = result[i].Link.replace("<","").replace(">","").replace("&","&nd;");
/*var icon = result[i].Engine.Image; */
?>

		<entry left="0" width="-1" top="@TOP" height="18"  >
			<draguri noelm="true"><![CDATA[@{uri}]]></draguri>
			<href_artist noelm="true"><![CDATA[@{artist_uri}]]></href_artist>
			<uri noelm="true"><![CDATA[@{uri}]]></uri>
			<href_album><![CDATA[@{album_uri}]]></href_album>
			<title noelm="true"><![CDATA[@{Title}]]></title>
			<artist noelm="true"><![CDATA[@{Artist}]]></artist>
			<album noelm="true"><![CDATA[@{Album}]]></album>
			
		</entry>
<? 
}catch(e){}
}?>
	</section>
	<? if(false){?>
	<section name="People">
		<label width="-1" height="20" color="#FFFFFF" size="12">Friends</label>
		<?
		var d =  synchronize_data("http://ws.audioscrobbler.com/2.0/?method=user.getfriends&user="+parameter+"&api_key=b25b959554ed76058ac220b7b2e0a026");
		var users = d.GetElementsByTagName("user");
		for(var i=0; i < users.Count; i++){ var user = users.Items(i);
			var img = user.GetElementsByTagName("image").Items(0).InnerText;
			var name = user.GetElementsByTagNae("name").Items(0).InnerText;
			
		?>
		<hbox height="64">
			<img href="@{service}:lastfm_user:@{name}" src="@{img}" width="64" height="64" />
			<label href="@{service}:lastfm_user:@{name}" flex="1" height="64" >@{name}</label>
		</hbox>
		<?
		}
		?>
	</section>
	<? } ?>
</view>